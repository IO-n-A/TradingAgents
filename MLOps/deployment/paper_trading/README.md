# MLOps Paper Trading Deployment

This directory contains scripts and configurations for deploying a trained Reinforcement Learning (RL) agent for paper trading, specifically using the Alpaca API as an example. Paper trading allows testing the agent's performance in a simulated live market environment without risking real capital.

## Files

*   **`deploy_to_alpaca.py`**:
    *   This script is responsible for connecting to the Alpaca paper trading API, fetching live or recent market data, processing it, getting trading decisions from the loaded RL agent, and submitting orders.
    *   It's designed to run continuously, making decisions at specified intervals.
    *   **Inputs:**
        *   Path to a trained RL agent model (from the model registry).
        *   Alpaca API keys (from `config/api_keys.yaml`).
        *   List of tickers to trade.
        *   Configuration for data processing and environment features (e.g., from `MLOps/config/environments/stock_trading_env_config.yaml` for tech indicators).
        *   Trading interval (e.g., every 1 minute, 5 minutes, etc.).
    *   **Functionality:**
        *   Connects to Alpaca.
        *   Enters a loop that:
            *   Fetches the latest market data (e.g., 1-minute bars).
            *   Preprocesses the data (calculates technical indicators, incorporates sentiment if available).
            *   Feeds the current state to the RL agent to get an action.
            *   Translates the action into a trade order (buy, sell, hold).
            *   Submits the order to the Alpaca paper trading account.
            *   Logs all actions, decisions, orders, and any errors.
        *   Handles API errors and attempts to reconnect if necessary.

## Workflow

1.  **Train and Register Model:** Ensure a robust RL agent has been trained, backtested, and saved to the `MLOps/model_registry/`.
2.  **Configure Alpaca Account:**
    *   Set up an Alpaca paper trading account.
    *   Store API Key ID and Secret Key securely in `config/api_keys.yaml` (e.g., under `alpaca.api_key_id_paper` and `alpaca.secret_key_paper`).
3.  **Configure Deployment Script:**
    *   Specify the path to the trained model in `deploy_to_alpaca.py` (likely via command-line argument).
    *   Define the list of tickers to trade.
    *   Set the trading interval.
    *   Ensure environment configurations (for feature generation) are consistent with the agent's training.
4.  **Run Deployment Script:** Execute `python MLOps/deployment/paper_trading/deploy_to_alpaca.py`.
5.  **Monitor Performance:**
    *   Track the paper trading account's performance via the Alpaca dashboard.
    *   Review logs generated by `deploy_to_alpaca.py` for decisions, trades, and errors.
    *   Compare paper trading results with backtesting results to identify discrepancies or areas for improvement.

## Key Considerations for Paper Trading:

*   **Data Latency:** Live data feeds can have latency. The script should account for potential delays.
*   **Slippage:** Paper trading often doesn't perfectly simulate slippage (difference between expected and actual execution price). Be mindful of this when evaluating results.
*   **API Limits:** Be aware of Alpaca API rate limits and design the script to operate within them.
*   **Error Handling:** Implement robust error handling for API connection issues, data fetching problems, and order submission failures.
*   **Logging:** Comprehensive logging is crucial for debugging and performance analysis. Log decisions, state representations, actions, order details, and any exceptions.
*   **Market Hours:** The script should ideally operate only during market hours, or handle pre/post-market data appropriately if the strategy intends to.
*   **Sentiment Integration (if applicable):** If the agent uses sentiment, the paper trading script must have a way to fetch and process news in near real-time to generate sentiment scores.

This paper trading setup provides a bridge between historical backtesting and potential live trading, offering a more realistic assessment of the agent's behavior in a dynamic market.